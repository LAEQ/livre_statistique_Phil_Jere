% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames*,x11names*}{xcolor}
%
\documentclass[
  11pt,
  french,
]{book}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
  \setmainfont[]{Palatino Linotype}
  \setmonofont[Scale=0.8]{Source Code Pro}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Introduction aux méthodes quantitatives en sciences sociales avec R},
  pdfauthor={Philippe Apparicio et Jérémy Gelb},
  pdflang={fr},
  colorlinks=true,
  linkcolor=Maroon,
  filecolor=Maroon,
  citecolor=Blue,
  urlcolor=Blue,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs}
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage[bf,singlelinecheck=off]{caption}
\usepackage[justification=centering]{caption}

\usepackage{framed,color}
\definecolor{shadecolor}{RGB}{248,248,248}
\definecolor{shadebluecolor}{RGB}{224,244,255}

\renewcommand{\textfraction}{0.05}
\renewcommand{\topfraction}{0.8}
\renewcommand{\bottomfraction}{0.8}
\renewcommand{\floatpagefraction}{0.75}

\renewenvironment{quote}{\begin{VF}}{\end{VF}}
\let\oldhref\href
\renewcommand{\href}[2]{#2\footnote{\url{#1}}}

\let\oldalign=\align
\renewcommand{\align}{\small\oldalign\normalsize}

\ifxetex
  \usepackage{letltxmacro}
  \setlength{\XeTeXLinkMargin}{1pt}
  \LetLtxMacro\SavedIncludeGraphics\includegraphics
  \def\includegraphics#1#{% #1 catches optional stuff (star/opt. arg.)
    \IncludeGraphicsAux{#1}%
  }%
  \newcommand*{\IncludeGraphicsAux}[2]{%
    \XeTeXLinkBox{%
      \SavedIncludeGraphics#1{#2}%
    }%
  }%
\fi

\makeatletter
\newenvironment{kframe}{%
\medskip{}
\setlength{\fboxsep}{.8em}
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\makeatletter
\newenvironment{kframev}{%
\medskip{}
\setlength{\fboxsep}{.8em}
 \def\at@end@of@kframev{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframev{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadebluecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframev}
\makeatother

\renewenvironment{Shaded}{\begin{kframe}}{\end{kframe}}

\usepackage{makeidx}
\makeindex

\urlstyle{tt}

\usepackage{amsthm}
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=8pt plus 2pt minus 4pt
  \thm@postskip=\thm@preskip
}

% Definition des environnements pour les blocks pdf---------------------------
\newenvironment{rmdblock}[1]
  {
  \begin{itemize}
  \renewcommand{\labelitemi}{
    \raisebox{-.7\height}[0pt][0pt]{
      {\setkeys{Gin}{width=3em,keepaspectratio}\includegraphics{images/#1}}
    }
  }
  \setlength{\fboxsep}{1em}
  \begin{kframev}
  \small
  \item
  }
  {
  \end{kframev}
  \end{itemize}
  }


\newenvironment{bloc_notes}
  {\begin{rmdblock}{notes}}
  {\end{rmdblock}}


\newenvironment{bloc_aller_loin}
  {\begin{rmdblock}{aller_loin}}
  {\end{rmdblock}}


\newenvironment{bloc_astuce}
  {\begin{rmdblock}{astuce}}
  {\end{rmdblock}}


\newenvironment{bloc_attention}
  {\begin{rmdblock}{attention}}
  {\end{rmdblock}}


\newenvironment{bloc_package}
  {\begin{rmdblock}{package}}
  {\end{rmdblock}}

\newenvironment{bloc_objectif}
  {\begin{rmdblock}{objectif}}
  {\end{rmdblock}}


% -------------------------------------------------------------------

% -------------------modifying existing environments-----------------

% changing font size of code chunks
\let\oldShaded\Shaded
\def\Shaded{\oldShaded\small}

%insuring adding a line break for level 5
\makeatletter
\renewcommand\paragraph{\@startsection{paragraph}{4}{\z@}%
   {-3.25ex\@plus -1ex \@minus -.2ex}%
   {1.5ex \@plus .2ex}%
   {\normalfont\normalsize\bfseries}}
\makeatother

% -------------------------------------------------------------------

\makeatother
\usepackage{flafter}
\usepackage{float}
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\ifxetex
  % Load polyglossia as late as possible: uses bidi with RTL langages (e.g. Hebrew, Arabic)
  \usepackage{polyglossia}
  \setmainlanguage[]{french}
\else
  \usepackage[shorthands=off,main=french]{babel}
\fi
\usepackage[]{natbib}
\bibliographystyle{apalike}

\title{Introduction aux méthodes quantitatives en sciences sociales avec R}
\author{Philippe Apparicio et Jérémy Gelb}
\date{2020-11-11}

\begin{document}
\maketitle

%\cleardoublepage\newpage\thispagestyle{empty}\null
%\cleardoublepage\newpage\thispagestyle{empty}\null
%\cleardoublepage\newpage
%\thispagestyle{empty}
%\begin{center}
%\Large{To Jung Jae-sung (1982 -- 2018),}

%\large{a remarkably hard-working badminton player with a remarkably simple playing style}
%\includegraphics{images/dedication.pdf}
%\end{center}

%\setlength{\abovedisplayskip}{-5pt}
%\setlength{\abovedisplayshortskip}{-5pt}

\renewcommand*\contentsname{Table des matières}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\listoftables
\listoffigures
\hypertarget{pruxe9face}{%
\chapter*{Préface}\label{pruxe9face}}
\addcontentsline{toc}{chapter}{Préface}

\hypertarget{comment-lire-ce-livre}{%
\section*{Comment lire ce livre}\label{comment-lire-ce-livre}}
\addcontentsline{toc}{section}{Comment lire ce livre}

Si vous googlez l'expression « comment lire un livre ? », vous trouverez une multitude de conseils et astuces. Pour ce livre, nous conseillons de le lire de gauche à droite et page par page. Plus sérieusement, il comprend plusieurs types de blocs de texte qui, on l'espère, faciliteront la lecture.

\begin{bloc_package}

\textbf{Bloc packages}: habituellement localisé en début du chapitre, il comprend la liste des packages R utilisés pour un chapitre.

\end{bloc_package}

\begin{bloc_objectif}

\textbf{Bloc objectif}: comprend une description des objectifs d'une section.

\end{bloc_objectif}

\begin{bloc_notes}

\textbf{Bloc notes}: comprend une information secondaire sur une notion, un élément, une idée abordée dans une section.

\end{bloc_notes}

\begin{bloc_aller_loin}

\textbf{Bloc pour aller plus loin} : peut comprendre des références ou des extensions d'une méthode statistique abordée dans une section.

\end{bloc_aller_loin}

\begin{bloc_astuce}

\textbf{Bloc astuce}: décrit un élément qui vous facilera le vie : une propriété statistique, un \emph{package}, une fonction, une syntaxe R.

\end{bloc_astuce}

\begin{bloc_attention}

\textbf{Bloc attention}: comprend une notion ou un élément important à bien maîtriser.

\end{bloc_attention}

\hypertarget{structure-du-livre}{%
\section*{Structure du livre}\label{structure-du-livre}}
\addcontentsline{toc}{section}{Structure du livre}

À écrire plus tard.

\hypertarget{remerciements}{%
\section*{Remerciements}\label{remerciements}}
\addcontentsline{toc}{section}{Remerciements}

Note au beau Cargo (chien Mira) qui nous supporte dans l'écriture du livre !

\begin{figure}

{\centering \includegraphics[width=0.5\linewidth]{images/Cargo} 

}

\caption{Cargo, le plus beau}\label{fig:cargo}
\end{figure}

\hypertarget{auteurs}{%
\chapter*{À propos des auteurs}\label{auteurs}}
\addcontentsline{toc}{chapter}{À propos des auteurs}

\textbf{Philippe Apparicio} (\url{http://www.ucs.inrs.ca/philippe-apparicio}) est professeur titulaire au Centre Urbanisation Culture Société de l'INRS (\url{http://www.ucs.inrs.ca/}). Il enseigne au programme de maîtrise en études urbaines (\url{http://www.ucs.inrs.ca/ucs/etudier/programmes/etudes-urbaines}) les cours \emph{méthodes quantitatives appliquées aux études urbaines} et \emph{analyses spatiales appliquées aux études urbaines}. Il a aussi créé et enseigné, il y a plusieurs années, le cours \emph{systèmes d'information géographique appliqués aux études urbaines}. Durant les dernières années, il a offert plusieurs formations aux Écoles d'été du Centre interuniversitaire québécois de statistiques sociales (CIQSS, \url{https://www.ciqss.org/}). Titulaire de la Chaire de recherche du Canada (niveau 2) sur l'équité environnementale et la ville, il est le directeur du \textbf{laboratoire d'équité environnementale} (\url{http://laeq.ucs.inrs.ca}). Géographe de formation, ses intérêts de recherche actuels incluent la justice et l'équité environnementale, la pollution atmosphérique et le bruit et le vélo en ville. Il a publié une centaine d'articles dans différents domaines des études urbaines et de la géographie.

\textbf{Jérémy Gelb} est candidat au doctorat en études urbaines à l'INRS (sous la supervision de Philippe Apparicio) et membre du \textbf{laboratoire d'équité environnementale} (\url{http://laeq.ucs.inrs.ca}). Son sujet de thèse porte sur l'exposition des cyclistes aux pollutions atmosphériques et sonores en milieu urbain. Il utilise quotidiennement des systèmes d'information géographique (SIG) et est tombé dans la marmite de l'\emph{open source} avec le triptyque QGIS, R et Python au début de sa maîtrise. Il a récemment développé deux packages R : \textbf{geocmeans} et \textbf{spNetwork}, permettant respectivement d'effectuer des analyses de classification floue non-supervisée pondérée spatialement et des estimations de densité par kernel sur réseau.

Philippe et Jérémy travaillent étroitement ensemble depuis déjà plusieurs années. Avec d'autres collègues, ils ont copubliés plusieurs articles \citep{2020_1, 2020_2, 2020_3, 2019_1, 2019_2, 2019_3, 2020_1, 2020_2, 2018_1, 2017_1, 2016_1}. Tous deux s'intéressent à l'exposition des cyclistes à la pollution atmosphérique et sonore dans plusieurs villes à travers le monde : Philippe ayant une préférence pour les collectes dans les villes du Sud Global (notamment indiennes, africaines et latino-américaines) et Jérémy dans les villes du Nord (européennes et nord-américaines).

\hypertarget{chap08}{%
\chapter{Régressions régression multiniveaux}\label{chap08}}

Dans le précédent chapitre, nous avons abordé les modèles à effets mixtes qui permettent d'introduire à la fois des effets fixes et des effets aléatoires (GLMM). Dans ce chapitre, nous poursuivons sur cette voie avec une nouvelle extension des modèles GLM~: les modèles multiniveaux. Ces modèles sont simplement une extension des modèles à effets mixtes et permettent de modéliser un phénomène avec une structure hiérarchique des données, tel que décrit dans le chapitre précédent.

\begin{bloc_notes}

\textbf{Rappel de la structure hiérarchique des données}

\textbf{Exemple à deux niveaux~:} il s'agit de modéliser un phénomène \(y_{ij}\), soit une variable dépendante \emph{Y} pour un individu \emph{i} (niveau) niché dans un groupe \emph{j} (niveau 2). Par exemple, modéliser l'indice de masse corporelle (IMC) de 5000 individus résidant dans 100 quartiers différents.

\textbf{Exemple à trois niveaux~:} il s'agit de modéliser un phénomène \(y_{ijk}\), soit une variable dépendante \emph{Y} pour un individu \emph{i} (niveau 1), niché dans un groupe \emph{j} (niveau 2) appartenant à un groupe \emph{k} (niveau 3). Par exemple, modéliser les notes à un examen de mathématiques d'élèves (niveau 1) nichés dans des classes (niveau 2) nichées dans des écoles (niveau 3).

\end{bloc_notes}

Nous avons largement décrits précédemment trois principaux types de modèles d'effets mixtes (GLMM) :

\begin{itemize}
\tightlist
\item
  les GLMM avec constantes aléatoires qui permettent d'avoir une constante différente pour chacun des groupes (niveau 2).
\item
  les GLMM avec pentes aléatoires qui permettent de faire varier une variable indépendante au niveau 1 (coefficient) en fonction des groupes au niveau 2.
\item
  les GLMM avec constantes et pentes aléatoires.
\end{itemize}

Les modèles multiniveau se différencient des modèles à effets mixtes puisqu'ils permettent d'introduire des variables indépendantes mesurées aux niveaux supérieurs (2 et 3).

\hypertarget{sect081}{%
\section{Les modèles multiniveaux : deux intérêts majeurs}\label{sect081}}

Les modèles multiniveaux ont deux principaux avantages : la répartition de la variance entre les différents niveaux et l'introduction de variables explicatives aux différents niveaux du modèle.

\hypertarget{sect0811}{%
\subsection{La répartition de la variance entre les différents niveaux}\label{sect0811}}

Les modèles multiniveaux permettent d'estimer comment se répartit la variance entre les différents niveaux du jeu de données. Dans les deux exemples de l'encadré précédent, ils permettraient de répondre aux questions suivantes :

\begin{itemize}
\tightlist
\item
  Quel niveau explique le plus l'IMC, le niveau individuel (niveau 1) ou le niveau contextuel (niveau 2)~?
\item
  Comment se répartit la variance des notes à l'examen de mathématiques entre les trois niveaux~? A-t-on plus de variance pour les individus (niveau 1) ou au sein des classes (niveau 2) ou entre les différentes écoles (niveau 3)~?
\end{itemize}

\hypertarget{sect0812}{%
\subsection{L'estimation des coefficients aux différents niveaux}\label{sect0812}}

Les modèles multiniveaux permettent d'estimer simultanément les coefficients de plusieurs variables indépendantes introduites à chacun des niveaux du modèle. Autrement dit, de voir comment les variables indépendantes introduites aux différents niveaux influencent la variable \emph{Y} dépendante mesurée au niveau 1. Si nous reprenons l'exemple à trois niveaux (élèves / classes / école), plusieurs facteurs peuvent influencer la réussite ou la performance scolaire des élèves aux différents niveaux~:

\begin{itemize}
\tightlist
\item
  \textbf{Variables indépendantes au niveau 1} (élève) : âge, sexe, statut socioéconomique, langue maternelle autre que la langue d'enseignement\ldots{}
\item
  \textbf{Variables indépendantes au niveau 2} (classe) : nombre d'élèves par classe, programme spécialisée ou pas\ldots{}
\item
  \textbf{Variables indépendantes au niveau 3} (école) : indice de défavorisation de l'école, école publique ou privée, qualité des infrastructures de l'école (bâtiment, gymnase, cour d'école)\ldots{}
\end{itemize}

Dans la même veine, afin d'illustrer l'apport des modèles multiniveau dans le champ de la géographie de la santé, Philibert et Apparicio \citeyearpar[p.~129]{philibert2007statistiques} signalent que «~pour un modèle à deux niveaux, il s'agit de modéliser \(y_{ij}\), par exemple l'IMC d'un individu \emph{i} (niveau 1) résidant dans un quartier \emph{j} (niveau 2). Il est alors possible de mettre des variables explicatives tant au niveau 1 (âge, sexe, revenu, niveau d'éducation, etc.) qu'au niveau 2 (niveau de défavorisation sociale du quartier, offre de services et d'équipements sportifs et récréatifs, caractéristiques de l'environnement urbain, etc.). Dans cet exemple, on peut voir comment la modélisation multiniveaux permet d'estimer simultanément les effets environnementaux et individuels de manière à distinguer la contribution de chacun des niveaux (ex.~: l'effet du revenu des individus et celui de la défavorisation du quartier) dans l'explication des variations géographiques observées~».

\begin{bloc_aller_loin}

\textbf{Évaluer les effets de milieu avec des analyses multiniveaux}

Dans les champs de la santé des populations et des études urbaines, les modèles multiniveaux sont largement mobilisés pour évaluer les effets de milieu (\emph{neighbourhoods effects} ou \emph{area effects} en anglais).

Atkinson et Kintrea \citeyearpar[p.~2278]{atkinson2001disentangling} définissent les « effets de milieu comme le changement net dans les potentialités de l'existence (\emph{life chances}) attribuable au fait de vivre dans un quartier (ou une zone) plutôt qu'un autre » (traduction libre). Les effets de milieu peuvent être positifs ou négatifs et peuvent concernant aussi bien les enfants que les adultes.

Les analyses multiniveaux sont particulièrement adaptées à l'évaluation des effets de milieu. En effet, plusieurs phénomènes -- état de santé, comportement ou choix individuels -- peuvent être en effet influencés à la fois par des caractéristiques individuelles (âge, sexe, niveau de revenu, niveau d'éducation, etc.) et par des caractéristiques contextuelles (caractéristiques du quartier).

Avec un modèle multiniveau, une fois contrôlées les caractéristiques individuelles (variables indépendantes mesurées au niveau 1), il est alors possible d'évaluer l'effet des caractéristiques du quartier (variables indépendantes mesurées au niveau 2) sur un phénomène \(y_{ij}\) mesuré pour un individu \emph{i} résidant dans un quartier \emph{j}.

\end{bloc_aller_loin}

\hypertarget{sect082}{%
\section{Les différents types de modèles multiniveaux}\label{sect082}}

\hypertarget{sect0821}{%
\subsection{Description du jeu de données utilisé}\label{sect0821}}

Dans le cadre de cette section, nous présenterons uniquement les modèles à deux niveaux, soit pour modéliser un phénomène \(y_{ij}\). Pour ce faire, nous utilisons des données tirées d'une étude de Pham et al.~\citeyearpar{apparicio2017disentangling}. Dans cet article, les auteurs souhaitent évaluer les effets des caractéristiques de la forme urbaine et des caractéristiques socioéconomiques sur la couverture des arbres de rues, et ce, à partir d'un modèle multiniveau. Ils disposent ainsi d'une structure hiérarchique des données avec deux niveaux~: les tronçons de rues (niveau 1, \emph{n}=10814) inclus dans un et un seul secteur de recensement (niveau 2, \emph{n}=312). La variable dépendante (\(y_{ij}\)) est le pourcentage de la superficie du tronçon de rue qui est couverte par des arbres, calculé à partir d'images satellites à haute résolution (Quickbird, 60 cm, septembre 2008). L'ensemble des variables utilisées pour les modèles sont reportées au tableau \ref{tab:datamulti}.

Sept variables indépendantes relatives à la forme urbaine sont mesurées au niveau des tronçons de rues tels que la largeur et la longueur de la rue, l'âge médian des bâtiments (introduit également au carré pour vérifier l'existence d'un effet curviliénaire; voir section \ref{05511}), les pourcentages de bâtiments résidentiels, de duplex et de triplex, le nombre de bâtiments et finalement la distance moyenne entre le bâtiment et la rue. Les variables indépendantes au niveau des 312 secteurs de recensement (niveau 2) sont extraites du recensement canadien de 2006 (tableau \ref{tab:datamulti}).

\textbackslash begin\{table\}

\caption{\label{tab:datamulti}Statistiques descriptives pour les variables des modèles multiniveaux}
\centering
\fontsize{8}{10}\selectfont

\textbackslash begin\{tabular\}{[}t{]}\{llccrr\}
\toprule
Nom \& Intitulé \& Type \& Niveau \& Moy. \& E.-T.\textbackslash{}
\midrule
PCTArb \& Arbres sur le tronçon de rue (\%) \& VD \& 1 \& 7,2 \& 10,7\textbackslash{}
Width \& Largeur des rues \& VI \& 1 \& 16,0 \& 7,3\textbackslash{}
Length \& Longueur de rues \& VI \& 1 \& 136,0 \& 87,8\textbackslash{}
AgeMed \& Age médian des bâtiments \& VI \& 1 \& 1 952,7 \& 28,3\textbackslash{}
ResiPCT \& Bâtiments résidentiels (\%) \& VI \& 1 \& 83,5 \& 28,0\textbackslash{}
\addlinespace
DuTriPct \& Duplex ou triplex (\%) \& VI \& 1 \& 41,8 \& 39,3\textbackslash{}
NoLog \& Nombre de bâtiments \& VI \& 1 \& 14,0 \& 14,4\textbackslash{}
Setback \& Distance entre le bâtiment et la rue \& VI \& 1 \& 7,2 \& 4,3\textbackslash{}
ValLog \& Valeur moyenne des logements (milliers de \$) \& VI \& 2 \& 267,6 \& 80,0\textbackslash{}
UDipPCT \& Diplômés universitaires (\%) \& VI \& 2 \& 16,9 \& 9,6\textbackslash{}
\addlinespace
PCTFRAVI \& Personnes à faible revenu (\%) \& VI \& 2 \& 30,3 \& 11,5\textbackslash{}
PCTIMGRE \& Immigrants récents (\%) \& VI \& 2 \& 10,0 \& 7,3\textbackslash{}
AvecEnf \& Ménages avec enfants (\%) \& VI \& 2 \& 34,8 \& 12,6\textbackslash{}
FranPCT \& Langue marternelle française (\%) \& VI \& 2 \& 66,9 \& 24,1\textbackslash{}
\bottomrule
\textbackslash end\{tabular\}
\textbackslash end\{table\}

\hypertarget{sect0822}{%
\subsection{Démarche classique pour les modèles multiniveaux}\label{sect0822}}

La démarche habituelle en analyses multiniveaux est de réaliser plusieurs modèles, allant du plus simple au plus complexe. Cette stratégie permet habituellement de bien cerner la répartition de la variance entre les différents niveaux et l'apport des variables explicatives introduites aux différents niveaux. De la sorte, cinq types de modèles peuvent être construits :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  le modèle vide (appelé aussi modèle inconditionnel) qui ne comprend aucune variables explicative et des constantes aléatoires au niveau 2.
\item
  le modèle avec uniquement les variables indépendantes au niveau 1 et des constantes aléatoires au niveau 2.
\item
  le modèle complet avec les variables indépendantes aux deux niveaux et des constantes aléatoires.
\item
  le modèle complet avec les variables indépendantes aux deux niveaux, incluant une interaction entre une variable indépendante mesurée au niveau 1 et une autre mesurée au niveau 2.
\item
  le modèle avec les variables indépendantes aux deux niveaux et des constantes et pentes aléatoires.
\end{enumerate}

Dans les sous-sections suivantes, nous détaillerons chacun de ces cinq modèles et prenant soin des montrer les similitudes qu'ils partagent avec les modèles à effets mixtes vus précédemment. Notez d'emblée que les trois premiers modèles sont les plus fréquemment utilisés.

\hypertarget{sect08221}{%
\subsubsection{Modèle vide}\label{sect08221}}

Comme son nom l'indique, le modèle vide ne comprend aucune variable explicative. Il consiste simplement à faire varier la constante du niveau 1 avec des effets aléatoires au niveau 2, ce qui explique qu'il est souvent comparé à une ANOVA avec des effets aléatoires. En d'autres termes, ce modèle correspond à un GLMM avec constantes aléatoires dans lequel aucun régresseur n'est inclus au niveau 1. D'ailleurs, si vous comparez l'équation \eqref{eq:multiniveauModeleVide} avec l'équation \eqref{eq:glmm2} au chapitre précédent, vous constaterez que seul les paramètres \(\beta_1 x_1\) ont été ôtés et qu'il comprend aussi deux variances : l'une fixe au niveau 1 (\(\sigma_e\)) et l'autre aléatoire (stochastique) au niveau 2 (\(\sigma_{\upsilon}\)).

\footnotesize

\begin{equation}
\begin{aligned}
&Y \sim Normal(\mu,\sigma_e)\\
&g(\mu) = \beta_0 + \upsilon \\
&\upsilon \sim Normal(0, \sigma_{\upsilon})) \\
&g(x) = x
\end{aligned}
\label{eq:multiniveauModeleVide}
\end{equation}
\normalsize

\textbf{Quel est alors l'intérêt de réaliser un modèle si simple?} À partir des deux variances, il est possible de calculer le \textbf{coefficient de corrélation intraclasse} (appelé \emph{intraclass-correlation} (ICC) en anglais) qui est le rapport entre la variance aléatoire et la somme des variances des deux niveaux, soit fixe et aléatoire (équation \eqref{eq:multiniveauIcc}). Ce coefficient varie ainsi de 0 à 1 et indique la proportion de la variance de la variable dépendante qui est imputable au niveau 2. Tous les auteurs s'entendent sur le fait qu'il est impératif de commencer une analyse de multiniveau en calculant ce modèle vide qui nous informe de la répartition de la variance entre les deux niveaux. On pourra ensuite analyser l'évolution de ce coefficient dans les modèles subséquents.

\footnotesize

\begin{equation}
\rho = \frac{\sigma_{\upsilon}}{\sigma_{\upsilon} + \sigma_{e}}
\label{eq:multiniveauIcc}
\end{equation}
\normalsize

Les résultats du modèle vide (inconditionnel) à partir des données de Pham et al.~\citeyearpar{apparicio2017disentangling} sont présentés au tableau \ref{tab:TableauModeleVide}. La variance du niveau 1 est de 92,93 contre 19,82 au niveau 2. Le coefficient de corrélation intraclasse vaut alors : \(19,82 / (19,82+92,93) = 0,1758\). Cela signifie que 18\% de la variance de la variable dépendante est imputable au niveau 2 (des secteurs de recensement) et 82\% au niveau 1 (des tronçons). Nous verrons comment évolue ce coefficient dans les modèles subséquents.

\begin{table}

\caption{\label{tab:TableauModeleVide}Résultats du modèle vide (modèle 1)}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{lrrr}
\toprule
Paramètre & Coefficient & Erreur-type & Valeur de T\\
\midrule
Effets fixes (niveau 1) &  &  & \\
Constante & 7,337 & 0,277 & 26,466\\
Répartition de la variance &  &  & \\
Variance (niveau 1) & 19,818 &  & \\
Variance (niveau 2) & 92,925 &  & \\
\addlinespace
Coefficient de corrélation intraclasse & 0,176 &  & \\
Qualité d'ajustement du modèle &  &  & \\
AIC & 80 305,219 &  & \\
R\textasciicircum{2} marginal & 0,000 &  & \\
R\textasciicircum{2} conditionnel & 0,176 &  & \\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{sect08222}{%
\subsubsection{Modèle avec les variables indépendantes du niveau 1}\label{sect08222}}

Dans ce second modèle, on introduit uniquement les variables explicatives au niveau 1. Par conséquent, ce modèle est tout simplement un modèle à effets mixtes (GLMM) avec des constantes aléatoires largement décrit à la section \ref{sect07121}). Si vous comparez l'équation du modèle vide (équation \eqref{eq:multiniveauIcc}) avec l'équation de ce modèle (équation \eqref{eq:multiniveauModele2}), vous constaterez que le paramètre \(\beta_1 x_1\) a été ajouté. Il correspond au coefficient pour la variable indépendante \(X_1\) mesurée au niveau 1 (effet fixe). On pourrait alors ajouter d'autres paramètres pour les autres variables indépendantes du modèle, soit \(\beta_1 x_1 + \beta_2 x_2+ \ldots + \beta_k x_k\) (\(k\) étant le nombre de variables explicatives mesurées au niveau 1, effets fixes).

\footnotesize

\begin{equation}
\begin{aligned}
&Y \sim Normal(\mu,\sigma_e)\\
&g(\mu) = \beta_0 + \beta_1 x_1 + \upsilon \\
&\upsilon \sim Normal(0, \sigma_{\upsilon})) \\
&g(x) = x
\end{aligned}
\label{eq:multiniveauModele2}
\end{equation}
\normalsize

Les résultats du second modèle sont présentés au tableau \ref{tab:TableauModele2}.

\textbf{La répartition de la variance entre les deux niveaux}. La variance du niveau 1 est désormais de 15,263 contre 80,317 au niveau 2, ce qui permet d'obtenir un coefficient de corrélation intraclasse de 0,1597. Cela signifie que de 16\% de la variance de la variable dépendante est imputable au niveau 2 (des secteurs de recensement), une fois contrôlées les caractéristiques des tronçons.

\textbf{La qualité d'ajustement du modèle}. Dans le chapitre précédent sur les GLMM, nous avons largement décrit plusieurs mesures de la qualité d'ajustement du modèle, notamment l'AIC et les R\textsuperscript{2} marginal et conditionnel. À titre de rappel, voici comment interpréter ces mesures :

\begin{itemize}
\item
  plus la valeur de l'AIC est faible, mieux le modèle est ajusté. En comparant les valeurs d'AIC pour le modèle vide et celui avec les variables explicatives du niveau 1 (80305 \emph{versus} 78785), on constate sans surprise que ce dernier modèle est plus performant.
\item
  le R\textsuperscript{2} marginal indique la proportion de la variance expliquée si uniquement les effets fixes avaient été pris en compte (ici 0,129). Quant au R\textsuperscript{2} conditionnel, il indique la proportion variance expliquée à la fois par les effets fixes et aléatoires (ici, 0,268). L'écart important entre les deux R\textsuperscript{2} signale que les secteurs de recensements (effets aléatoires, niveau 2) jouent un rôle important dans le modèle.
\end{itemize}

\textbf{Quelles informations peut-on tirer des coefficients de régression ?}
Les variables indépendantes relatives à la forme urbaine les plus importantes sont : le pourcentage de bâtiments résidentiels (\texttt{ResiPCT}), la largeur de la rue (\texttt{Width}) et le nombre de bâtiments (\texttt{NoLog}). Aussi, la distance entre le bâtiment et la rue (\texttt{Setback}) est associée positivement avec la variable dépendante. En effet, à chaque ajout d'un mètre de la distance moyenne entre les bâtiments et le tronçon de rue, la couverture des arbres sur le tronçon augmente de 0,202 point de pourcentage, toutes choses étant égales par ailleurs.

\begin{table}

\caption{\label{tab:TableauModele2}Résultats du modèle avec les variables indépendantes au niveau 1 (modèle 2)}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{lrrr}
\toprule
Paramètre & Coefficient & Erreur-type & Valeur de T\\
\midrule
Effets fixes (niveau 1) &  &  & \\
Constante & -1 028,618 & 179,736 & -5,723\\
Width & -0,129 & 0,013 & -10,160\\
Length & 0,011 & 0,002 & 6,322\\
AgeMed & 1,103 & 0,186 & 5,946\\
\addlinespace
AgeMed2 & 0,000 & 0,000 & -6,158\\
ResiPCT & 0,047 & 0,003 & 13,558\\
DuTriPct & -0,013 & 0,003 & -4,842\\
NoLog & 0,147 & 0,011 & 13,938\\
Setback & 0,202 & 0,023 & 8,792\\
\addlinespace
Répartition de la variance &  &  & \\
Variance (niveau 1) & 15,263 &  & \\
Variance (niveau 2) & 80,317 &  & \\
Coefficient de corrélation intraclasse & 0,160 &  & \\
Qualité d'ajustement du modèle &  &  & \\
\addlinespace
AIC & 78 785,827 &  & \\
R\textasciicircum{2} marginal & 0,129 &  & \\
R\textasciicircum{2} conditionnel & 0,268 &  & \\
\bottomrule
\end{tabular}
\end{table}

Remarquez la valeur de la constante : −1028,618. À titre de rappel, la constante est la valeur que prend la variable dépendante quand toutes les variables indépendantes sont égales à 0. Or, il est impossible qu'elles soient toutes à zéro.

\begin{bloc_astuce}

\textbf{Le centrage des variables quantitatives mesurées au niveau 1}

En analyse multiniveau, il est très courant et souvent recommandé de centrer les variables explicatives quantitatives au niveau 1. Deux options sont alors possibles :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Pour une variable indépendante donnée, les observations sont centrées sur leur moyenne générale, c'est-à-dire la moyenne de l'ensemble des observations du jeu de données, soit \(X_{ij} - \bar{X}\). Dans ce cas, la constante est donc la valeur que prend la variable \(Y\) quand toutes les variables indépendantes sont égales à leur moyenne respective.
\item
  Chaque observation est centrée sur la moyenne de son groupe respectif, soit \(X_{ij} - \bar{X}_{.j}\).
\end{enumerate}

Tel que signalé par Bressoux \citeyearpar[p.~328]{bressoux2010}, « dans le premier cas, la variance des pentes sera estimée pour l'individu moyen dans la distribution générale, tandis que dans le second elle est estimée pour l'individu moyen de chaque groupe ».

Autrement dit, comparativement à un modèle sans centrage, les valeurs des coefficients pour les variables indépendantes seront les mêmes dans le premier cas (seule la valeur de la constante va changer) tandis qu'ils seront différents dans le second cas.

Attention, on n'appliquera pas de centrage sur une variable qualitative, qu'elle soit dichotmonique, nominale ou ordinale.

\textbf{Pourquoi la pratique du centrage en analyses multiniveaux est si courante?}

Dans la plupart des livres sur les régressions multiniveaux, le centrage est recommandé, notamment dans l'ouvrage classique de Raudenbush et Bryk \citeyearpar{raudenbush2002hierarchical}. Rappelons que ces modèles sont largement utilisés en éducation avec une structure hiérarchique classique élève / école / classe. On s'intéresse alors à l'individu moyen, ici l'élève, ce qui explique que le centrage est habituellement appliqué. Par exemple, ne pas centrer l'âge des élèves fait que la constante qui sera obtenue est peu interprétable : difficile d'évaluer la note moyenne à un examen quand la variable âge de l'élève a la valeur de 0, tout comme les autres variables explicatives quantitatives relatives à l'élève.

\textbf{Centrage et réduction de l'ensemble des variables du modèle}

Il est à noter que certains auteurs vont centrer et réduire l'ensemble des variables du modèle. À titre de rappel, le centrage consiste à soustraire à chaque valeur sa moyenne et la réduction à la diviser par l'écart-type (section \ref{02552}). Pour chaque variable, la moyenne est alors égale à 0 et l'écart-type à 1. Les coefficients s'interprètent alors en termes d'augmentation d'une unité d'écart tant pour la VI que la VD. Ils correspondent alors à des coefficients de régression standardisés (abordés dans la section \ref{0542}).
Ce processus de centrage et de réduction des variables peut être motivé par des problèmes de converge du modèle.

\end{bloc_astuce}

Par conséquent, nous vous proposons de centrer les variables du niveau 1 de notre jeu de données. Si vous comparez les tableaux \ref{tab:TableauModele2} et \ref{tab:TableauModele2b}, vous constaterez que les valeurs relatives aux coefficients, aux mesures de la répartition de la variance et de la qualité d'ajustement du modèle sont les mêmes. Seule la valeur de la constante change : elle passe de −1028,618 à 7,228. Elle s'interprète désormais de la façon suivante : si toutes les variables explicatives étaient égales à leurs moyennes respectives, alors le pourcentage de la superficie du tronçon couverte par des arbres serait égal à 7,228\%.

\begin{table}

\caption{\label{tab:TableauModele2b}Résultats du modèle avec les variables indépendantes centrées au niveau 1 (modèle 2)}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{lrrr}
\toprule
Paramètre & Coefficient & Erreur-type & Valeur de T\\
\midrule
Effets fixes (niveau 1) &  &  & \\
Constante & 7,228 & 0,248 & 29,151\\
Width.c & -0,129 & 0,013 & -10,160\\
Length.c & 0,011 & 0,002 & 6,322\\
AgeMed.c & 1,103 & 0,186 & 5,946\\
\addlinespace
AgeMed2.c & 0,000 & 0,000 & -6,158\\
ResiPCT.c & 0,047 & 0,003 & 13,558\\
DuTriPct.c & -0,013 & 0,003 & -4,842\\
NoLog.c & 0,147 & 0,011 & 13,938\\
Setback.c & 0,202 & 0,023 & 8,792\\
\addlinespace
Répartition de la variance &  &  & \\
Variance (niveau 1) & 15,263 &  & \\
Variance (niveau 2) & 80,317 &  & \\
Coefficient de corrélation intraclasse & 0,160 &  & \\
Qualité d'ajustement du modèle &  &  & \\
\addlinespace
AIC & 78 785,827 &  & \\
R\textasciicircum{2} marginal & 0,129 &  & \\
R\textasciicircum{2} conditionnel & 0,268 &  & \\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{sect08223}{%
\subsubsection{Modèle complet avec les variables indépendantes aux niveaux 1 et 2}\label{sect08223}}

Le troisième type de modèle consiste à introduire à la fois les variables explicatives mesurées au niveau 1 et au niveau 2 (équation \eqref{eq:multiniveauModele3}). Il est alors communément appelé le modèle complet. Les variables explicatives du niveau 2 sont aussi des effets fixes.

\footnotesize

\begin{equation}
\begin{aligned}
&Y \sim Normal(\mu,\sigma_e)\\
&g(\mu)  = \underbrace{\beta_0 + \beta_1 x_1}_{\mbox{effets fixes (niveau 1)}}+ \underbrace{\beta_2 z_2}_{\mbox{effets fixes (niveau 2)}}+\epsilon \\
&\upsilon \sim Normal(0, \sigma_{\upsilon})) \\
&g(x) = x
\end{aligned}
\label{eq:multiniveauModele3}
\end{equation}
\normalsize

Les résultats de troisième second modèle sont présentés au tableau \ref{tab:TableauModele3}. Il est alors possible d'évaluer les effets des caractéristiques socioéconomiques (mesurés au niveau des secteurs de recensement) sur la couverture des arbres des îlots, une fois contrôlées les caractéristiques de la forme urbaine des tronçons. Rappelons que dans ce modèle, les constantes sont aléatoires et que les variables indépendantes au niveau 1 sont centrées.

\textbf{Quelles informations peut-on tirer des coefficients de régression du niveau 2?}
D'emblée, deux caractéristiques n'ont pas d'effet significatif sur la variable dépendante, soit les pourcentages de diplômés universitaires et de ménages avec enfants. Par contre, toutes choses étant égales par ailleurs, la valeur moyenne des logements et le pourcentage d'immigrants récents sont associés à une augmentation de la couverture végétale. À l'inverse, le pourcentage de personnes à faible revenu est associé à une diminution de la couverture végétale.

\begin{table}

\caption{\label{tab:TableauModele3}Résultats du modèle avec les variables indépendantes aux niveaux 1 et 2 (modèle 3)}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{lrrr}
\toprule
Paramètre & Coefficient & Erreur-type & Valeur de T\\
\midrule
Effets fixes (niveau 1 : tronçons) &  &  & \\
Constante & -0,518 & 3,227 & -0,160\\
Width.c & -0,132 & 0,013 & -10,375\\
Length.c & 0,011 & 0,002 & 6,265\\
AgeMed.c & 1,097 & 0,185 & 5,920\\
\addlinespace
AgeMed2.c & 0,000 & 0,000 & -6,136\\
ResiPCT.c & 0,046 & 0,003 & 13,352\\
DuTriPct.c & -0,013 & 0,003 & -4,737\\
NoLog.c & 0,148 & 0,011 & 13,985\\
Setback.c & 0,194 & 0,023 & 8,428\\
\addlinespace
Effets fixes (niveau 2 : secteurs de recensement) &  &  & \\
ValLog & 0,016 & 0,004 & 4,126\\
UDipPCT & 0,014 & 0,035 & 0,396\\
PCTFRAVI & -0,088 & 0,030 & -2,988\\
PCTIMGRE & 0,237 & 0,049 & 4,870\\
\addlinespace
AvecEnf & 0,001 & 0,032 & 0,018\\
FranPCT & 0,052 & 0,016 & 3,183\\
Répartition de la variance &  &  & \\
Variance (niveau 1) & 12,121 &  & \\
Variance (niveau 2) & 80,347 &  & \\
\addlinespace
Coefficient de corrélation intraclasse & 0,131 &  & \\
Qualité d'ajustement du modèle &  &  & \\
AIC & 78 776,845 &  & \\
R\textasciicircum{2} marginal & 0,160 &  & \\
R\textasciicircum{2} conditionnel & 0,270 &  & \\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{sect08224}{%
\subsubsection{Modèle avec une interaction entre deux niveaux}\label{sect08224}}

Dans la section \ref{sect0554}, nous avons vu comment introduire des variables d'interaction dans une régression linéaire multiple, soit entre deux variables continues (section \ref{sect05541}), soit entre une variable continue et une variable dichotomique (section \ref{sect05542}), soit entre deux variables dichotomiques (section \ref{sect05543}). En analyse multiniveau, il peut être pertinent d'introduire une interaction entre une variable mesurée au niveau 1 et une autre mesurée au niveau 2 (équation \eqref{eq:multiniveauModele4}).

\footnotesize

\begin{equation}
\begin{aligned}
&Y \sim Normal(\mu,\sigma_e)\\
&g(\mu)  = \underbrace{\beta_0 + \beta_1 x_1}_{\mbox{effets fixes (niveau 1)}}+ \underbrace{\beta_2 z_2}_{\mbox{effets fixes (niveau 2)}}+ \underbrace{\beta_3 (x_1 \times z_2)}_{\mbox{interaction (niveaux 1 et 2)}}+ \epsilon \\
&\upsilon \sim Normal(0, \sigma_{\upsilon})) \\
&g(x) = x
\end{aligned}
\label{eq:multiniveauModele4}
\end{equation}
\normalsize

Dans le tableau \ref{tab:TableauModele4}, nous introduisons une variable d'interaction entre la \emph{distance entre le bâtiment et la rue} (\texttt{Setback.c}) et le \emph{pourcentage de personnes à faible revenu} (\texttt{PCTFRAVI}). On constate alors que \texttt{PCTFRAVI} est associé négativement avec la variable dépendante (\(\beta=\)−0,079, T=−2,684). Toutefois, lorsqu'il est mis en interaction avec la variable \texttt{Setback.c}, cette variable est significative et positive (\$\beta=\$0,008, T=4,591).

\begin{table}

\caption{\label{tab:TableauModele4}Résultats du modèle avec une variable d'interaction entre les deux niveaux 1 et 2 (modèle 4)}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{lrrr}
\toprule
Paramètre & Coefficient & Erreur-type & Valeur de T\\
\midrule
Effets fixes (niveau 1 : tronçons) &  &  & \\
Constante & -0,009 & 3,198 & -0,003\\
Width.c & -0,136 & 0,013 & -10,660\\
Length.c & 0,011 & 0,002 & 6,289\\
AgeMed.c & 1,092 & 0,185 & 5,894\\
\addlinespace
AgeMed2.c & 0,000 & 0,000 & -6,114\\
ResiPCT.c & 0,046 & 0,003 & 13,239\\
DuTriPct.c & -0,013 & 0,003 & -4,742\\
NoLog.c & 0,145 & 0,011 & 13,747\\
Setback.c & 0,003 & 0,048 & 0,072\\
\addlinespace
Effets fixes (niveau 2 : secteurs de recensement) &  &  & \\
ValLog & 0,016 & 0,004 & 4,141\\
UDipPCT & 0,009 & 0,035 & 0,268\\
PCTFRAVI & -0,079 & 0,029 & -2,684\\
PCTIMGRE & 0,219 & 0,048 & 4,543\\
\addlinespace
AvecEnf & -0,007 & 0,032 & -0,221\\
FranPCT & 0,050 & 0,016 & 3,072\\
Variable d'interaction (niv 1 et 2) &  &  & \\
Setback X PCTFRAVI & 0,008 & 0,002 & 4,591\\
Répartition de la variance &  &  & \\
\addlinespace
Variance (niveau 1) & 11,829 &  & \\
Variance (niveau 2) & 80,239 &  & \\
Coefficient de corrélation intraclasse & 0,128 &  & \\
Qualité d'ajustement du modèle &  &  & \\
AIC & 78 768,659 &  & \\
\addlinespace
R\textasciicircum{2} marginal & 0,163 &  & \\
R\textasciicircum{2} conditionnel & 0,270 &  & \\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{sect083}{%
\section{Conditions d'application des régression multiniveau}\label{sect083}}

Puisque les modèles multiniveaux sont une extension des modèles à effets mixtes (GLMM), on va retrouver globalement les mêmes conditions d'applications (voir la section \ref{sect073}), dont les principales sont :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  l'absence de multicollinéarité excessive
\item
  la normalité des résidus
\item
  l'absence d'observations trop influentes dans le modèle.
\end{enumerate}

\textbf{Combien de groupes au niveau 2?} Dans la section \ref{sect073} Nous avons vu que dans un modèle GLMM certains auteurs, notamment Gelman et Hill
\citeyearpar{gelman2006data}, préconisent un minimum de cinq groupes dans un modèle à effets mixtes.

Toutefois, dans un modèle complet d'une régression multiniveau, nous introduisons aussi des variables indépendantes au niveau 2. Par conséquent, le nombre de groupes doit être augmenté significativement, et ce, idéalement proportionnellement au nombre des variables indépendantes ajoutées au niveau 2. En ce sens, Bressoux \citeyearpar[p.~325]{bressoux2010} conseille d'avoir au moins 10 groupes pour chaque variable indépendante mesurée au niveau 2. Toujours selon Bressoux \citeyearpar[p.~325]{bressoux2010}, certains auteurs recommandent même 20 groupes par variable indépendante au niveau 2. En conséquence, bien qu'aucune règle de pouce soit clairement admise, il est clair qu'un modèle complet multiniveau nécessite un nombre de groupes conséquent.

\hypertarget{sect084}{%
\section{Mise en œuvre dans R}\label{sect084}}

Pour mettre en œuvre des modèles multiniveau avec une variable dépendante continue, on utilise la fonction \texttt{lmer} du \emph{package} \textbf{lme4}. Pour d'autres distributions, on pourra utiliser la fonction \texttt{glmer} implémentant différentes familles de modèles GLM, notamment binomiale (modèle multiniveau logistique), gaussien, gamma, inverse gaussien, poisson, quasi-poisson, etc. Comme pour les modèles GLMM, lorsque d'autres distributions sont nécessaires, il est possible d'utiliser le \emph{package} \textbf{gamlss}.

\hypertarget{sect0841}{%
\subsection{Le modèle vide}\label{sect0841}}

Dans le code R ci-dessous, la syntaxe \texttt{lmer(PCTArb\ \textasciitilde{}\ 1\ +\ (1\textbar{}\ SRNOM),\ \ data\ =\ Multiniveau)} permet de construire le modèle vide avec la variable indépendante \texttt{PCTArb} et \texttt{SRNOM} comme variable définissant les groupes au niveau 2, soit les 312 secteurs de recensement. À titre de rappel, le modèle vide ne comprend aucune variable indépendante.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(}\StringTok{"lme4"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{"performance"}\NormalTok{)}
\KeywordTok{library}\NormalTok{(}\StringTok{"MuMIn"}\NormalTok{)}
\CommentTok{# chargement du jeu de données}
\KeywordTok{load}\NormalTok{(}\StringTok{"data/multiniveau/dataArbres.RData"}\NormalTok{)}

\CommentTok{# MODÈLE 1 : modèle vide (sans prédicteurs)}
\CommentTok{#------------------------------------------------------}
\CommentTok{# Écrire Y ~ 1 signifie que le modèle est vide}
\CommentTok{# 1| SRNOM : signifie que l'on fait varier la constante avec la variable SRNOM}
\NormalTok{Modele1 <-}\StringTok{ }\KeywordTok{lmer}\NormalTok{(PCTArb }\OperatorTok{~}\StringTok{ }\DecValTok{1} \OperatorTok{+}\StringTok{ }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\StringTok{ }\NormalTok{SRNOM),  }\DataTypeTok{data =}\NormalTok{ Multiniveau)}

\CommentTok{# Nombre de groupes}
\KeywordTok{cat}\NormalTok{(}\StringTok{"nombre de groupes ="}\NormalTok{, }\KeywordTok{length}\NormalTok{(}\KeywordTok{unique}\NormalTok{(Multiniveau}\OperatorTok{$}\NormalTok{SRNOM)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## nombre de groupes = 312
\end{verbatim}

La fonction \texttt{summary(Modele1)} permet d'afficher les résultats du modèle. Dans la section intitulée \texttt{Random\ effects}, la variance pour le niveau 2 (\texttt{SRNOM\ (Intercept)}) est de 19,82 contre 92,93 pour le niveau 1 (\texttt{Residual}). Le coefficient de corrélation intraclasse (ICC) est donc égal à \(19,82 / (19,82+92,93) \times 100 = 17,58%
\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Résultats du modèle}
\KeywordTok{summary}\NormalTok{(Modele1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed model fit by REML ['lmerMod']
## Formula: PCTArb ~ 1 + (1 | SRNOM)
##    Data: Multiniveau
## 
## REML criterion at convergence: 80299.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.9413 -0.5295 -0.2235  0.2175  8.4695 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  SRNOM    (Intercept) 19.82    4.452   
##  Residual             92.93    9.640   
## Number of obs: 10814, groups:  SRNOM, 312
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)   7.3373     0.2772   26.47
\end{verbatim}

Notez qu'il est possible d'obtenir directement la valeur de l'ICC avec la fonction \texttt{icc(Modele1)} du \emph{package} \textbf{performance} et les statistiques d'ajustement du modèle avec les fonctions \texttt{logLik}, \texttt{AIC} et \texttt{BIC}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul de l'ICC (coefficient intraclasse)}
\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Intraclass Correlation Coefficient
## 
##      Adjusted ICC: 0.176
##   Conditional ICC: 0.176
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ICC1 <-}\StringTok{ }\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele1)}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Part de la variance de la variable dépendante imputable au niveau 2 : "}\NormalTok{, }
    \KeywordTok{round}\NormalTok{(ICC1}\OperatorTok{$}\NormalTok{ICC_adjusted}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{), }\StringTok{"%"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Part de la variance de la variable dépendante imputable au niveau 2 : 17.58%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Qualité d'ajustement du modèle}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Statistiques d'ajustement du modèle :"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{-2 Log V = "}\NormalTok{, }\DecValTok{-2}\OperatorTok{*}\KeywordTok{logLik}\NormalTok{(Modele1),}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{AIC ="}\NormalTok{, }\KeywordTok{AIC}\NormalTok{(Modele1), }
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{BIC ="}\NormalTok{, }\KeywordTok{BIC}\NormalTok{(Modele1))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Statistiques d'ajustement du modèle : 
## -2 Log V =  80299.22 
## AIC = 80305.22 
## BIC = 80327.08
\end{verbatim}

\hypertarget{sect08412}{%
\subsection{Le modèle avec les variables indépendantes du niveau 1}\label{sect08412}}

Le second modèle consiste à introduire les variables indépendantes mesurées au niveau des tronçons de rues (niveau 1). Notez comment sont centrées préalablement les variables explicatives

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Centrage des variables indépendantes}
\NormalTok{VINiv1 <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Width"}\NormalTok{,}\StringTok{"Length"}\NormalTok{,}\StringTok{"AgeMed"}\NormalTok{,}\StringTok{"AgeMed2"}\NormalTok{,}\StringTok{"ResiPCT"}\NormalTok{,}\StringTok{"DuTriPct"}\NormalTok{,}\StringTok{"NoLog"}\NormalTok{,}\StringTok{"Setback"}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ (e }\ControlFlowTok{in}\NormalTok{ VINiv1)\{}
\NormalTok{  e.c <-}\StringTok{ }\KeywordTok{paste}\NormalTok{(e, }\StringTok{".c"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\NormalTok{  Multiniveau[[e.c]] <-}\StringTok{ }\NormalTok{Multiniveau[[e]] }\OperatorTok{-}\StringTok{ }\KeywordTok{mean}\NormalTok{(Multiniveau[[e]])}
\NormalTok{\}}

\CommentTok{# MODÈLE 2 : modèle avec les prédicteurs au niveau 1 (rues) }
\CommentTok{# ------------------------------------------------------}
\NormalTok{Modele2 <-}\StringTok{ }\KeywordTok{lmer}\NormalTok{(PCTArb }\OperatorTok{~}
\StringTok{                  }\CommentTok{# Variables indépendantes au niveau 1}
\StringTok{                   }\NormalTok{Width.c}\OperatorTok{+}\NormalTok{Length.c}\OperatorTok{+}\NormalTok{AgeMed.c}\OperatorTok{+}\NormalTok{AgeMed2.c}\OperatorTok{+}\NormalTok{ResiPCT.c}\OperatorTok{+}\NormalTok{DuTriPct.c}\OperatorTok{+}\NormalTok{NoLog.c}\OperatorTok{+}\NormalTok{Setback.c}\OperatorTok{+}
\StringTok{                   }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\StringTok{ }\NormalTok{SRNOM), }\DataTypeTok{data =}\NormalTok{ Multiniveau)}

\CommentTok{# Résultats du modèle}
\KeywordTok{summary}\NormalTok{(Modele2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed model fit by REML ['lmerMod']
## Formula: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c +  
##     DuTriPct.c + NoLog.c + Setback.c + (1 | SRNOM)
##    Data: Multiniveau
## 
## REML criterion at convergence: 78763.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.9065 -0.5536 -0.1941  0.2569  9.4205 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  SRNOM    (Intercept) 15.26    3.907   
##  Residual             80.32    8.962   
## Number of obs: 10814, groups:  SRNOM, 312
## 
## Fixed effects:
##               Estimate Std. Error t value
## (Intercept)  7.228e+00  2.479e-01  29.151
## Width.c     -1.292e-01  1.272e-02 -10.160
## Length.c     1.085e-02  1.717e-03   6.322
## AgeMed.c     1.103e+00  1.856e-01   5.946
## AgeMed2.c   -2.950e-04  4.791e-05  -6.158
## ResiPCT.c    4.699e-02  3.466e-03  13.558
## DuTriPct.c  -1.299e-02  2.683e-03  -4.842
## NoLog.c      1.473e-01  1.057e-02  13.938
## Setback.c    2.018e-01  2.295e-02   8.792
## 
## Correlation of Fixed Effects:
##            (Intr) Wdth.c Lngth. AgMd.c AgMd2. RsPCT. DTrPc. NoLg.c
## Width.c    -0.003                                                 
## Length.c    0.011 -0.216                                          
## AgeMed.c    0.000  0.010 -0.014                                   
## AgeMed2.c   0.002 -0.011  0.013 -1.000                            
## ResiPCT.c   0.056  0.095  0.208  0.023 -0.024                     
## DuTriPct.c -0.010  0.022  0.086 -0.074  0.077  0.025              
## NoLog.c    -0.030  0.156 -0.785 -0.008  0.009 -0.269 -0.127       
## Setback.c   0.048 -0.018 -0.146  0.007 -0.008 -0.014  0.035  0.038
## fit warnings:
## Some predictor variables are on very different scales: consider rescaling
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul de l'ICC (coefficient intra-classe)}
\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Intraclass Correlation Coefficient
## 
##      Adjusted ICC: 0.160
##   Conditional ICC: 0.139
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ICC2 <-}\StringTok{ }\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele2)}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Part de la variance de la variable dépendante "}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{imputable au niveau 2 : "}\NormalTok{, }\KeywordTok{round}\NormalTok{(ICC2}\OperatorTok{$}\NormalTok{ICC_adjusted}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{), }\StringTok{"%"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Part de la variance de la variable dépendante 
## imputable au niveau 2 : 15.97%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul des R2 conditionnel et marginal avec les fonctions}
\CommentTok{# r.squaredGLMM ou r2_nakagawa du package performance}
\KeywordTok{r.squaredGLMM}\NormalTok{(Modele2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            R2m       R2c
## [1,] 0.1292872 0.2683329
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{r2_nakagawa}\NormalTok{(Modele2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # R2 for Mixed Models
## 
##   Conditional R2: 0.268
##      Marginal R2: 0.129
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Qualité d'ajustement du modèle}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Statistiques d'ajustement du modèle"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{-2 Log L = "}\NormalTok{, }\DecValTok{-2}\OperatorTok{*}\KeywordTok{logLik}\NormalTok{(Modele2),}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{AIC ="}\NormalTok{, }\KeywordTok{AIC}\NormalTok{(Modele2), }
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{BIC ="}\NormalTok{, }\KeywordTok{BIC}\NormalTok{(Modele2))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Statistiques d'ajustement du modèle 
## -2 Log L =  78763.83 
## AIC = 78785.83 
## BIC = 78866
\end{verbatim}

\hypertarget{sect08413}{%
\subsection{Le modèle avec les variables indépendantes aux niveau 1 et 2}\label{sect08413}}

Le troisième modèle comprend à la fois les variables indépendantes mesurées aux deux niveaux (tronçons et secteurs de recensement).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# MODÈLE 3 : modèle complet avec les prédicteurs au niveau 1 et 2}
\CommentTok{# ------------------------------------------------------}
\NormalTok{Modele3 <-}\StringTok{ }\KeywordTok{lmer}\NormalTok{(PCTArb }\OperatorTok{~}
\StringTok{                  }\CommentTok{# Variables indépendantes au niveau 1}
\StringTok{                   }\NormalTok{Width.c}\OperatorTok{+}\NormalTok{Length.c}\OperatorTok{+}\NormalTok{AgeMed.c}\OperatorTok{+}\NormalTok{AgeMed2.c}\OperatorTok{+}\NormalTok{ResiPCT.c}\OperatorTok{+}\NormalTok{DuTriPct.c}\OperatorTok{+}\NormalTok{NoLog.c}\OperatorTok{+}\NormalTok{Setback.c}\OperatorTok{+}
\StringTok{                  }\CommentTok{# Variables indépendantes au niveau 2}
\StringTok{                  }\NormalTok{ValLog}\OperatorTok{+}\NormalTok{UDipPCT}\OperatorTok{+}\NormalTok{PCTFRAVI}\OperatorTok{+}\NormalTok{PCTIMGRE}\OperatorTok{+}\NormalTok{AvecEnf}\OperatorTok{+}\NormalTok{FranPCT}\OperatorTok{+}
\StringTok{                  }\NormalTok{(}\DecValTok{1}\OperatorTok{|}\StringTok{ }\NormalTok{SRNOM), }\DataTypeTok{data =}\NormalTok{ Multiniveau)}

\CommentTok{# Résultats du modèle}
\KeywordTok{summary}\NormalTok{(Modele3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed model fit by REML ['lmerMod']
## Formula: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c +  
##     DuTriPct.c + NoLog.c + Setback.c + ValLog + UDipPCT + PCTFRAVI +  
##     PCTIMGRE + AvecEnf + FranPCT + (1 | SRNOM)
##    Data: Multiniveau
## 
## REML criterion at convergence: 78742.8
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0461 -0.5558 -0.1939  0.2622  9.4190 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  SRNOM    (Intercept) 12.12    3.482   
##  Residual             80.35    8.964   
## Number of obs: 10814, groups:  SRNOM, 312
## 
## Fixed effects:
##               Estimate Std. Error t value
## (Intercept) -5.175e-01  3.227e+00  -0.160
## Width.c     -1.319e-01  1.271e-02 -10.375
## Length.c     1.076e-02  1.717e-03   6.265
## AgeMed.c     1.097e+00  1.854e-01   5.920
## AgeMed2.c   -2.936e-04  4.785e-05  -6.136
## ResiPCT.c    4.649e-02  3.482e-03  13.352
## DuTriPct.c  -1.268e-02  2.677e-03  -4.737
## NoLog.c      1.478e-01  1.057e-02  13.985
## Setback.c    1.944e-01  2.307e-02   8.428
## ValLog       1.591e-02  3.856e-03   4.126
## UDipPCT      1.405e-02  3.546e-02   0.396
## PCTFRAVI    -8.837e-02  2.958e-02  -2.988
## PCTIMGRE     2.367e-01  4.860e-02   4.870
## AvecEnf      5.778e-04  3.226e-02   0.018
## FranPCT      5.213e-02  1.638e-02   3.183
## fit warnings:
## Some predictor variables are on very different scales: consider rescaling
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Qualité d'ajustement du modèle}
\KeywordTok{cat}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{Statistiques d'ajustement du modèle"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{-2 Log L = "}\NormalTok{, }\DecValTok{-2}\OperatorTok{*}\KeywordTok{logLik}\NormalTok{(Modele3),}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{AIC ="}\NormalTok{, }\KeywordTok{AIC}\NormalTok{(Modele3), }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{BIC ="}\NormalTok{, }\KeywordTok{BIC}\NormalTok{(Modele3))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Statistiques d'ajustement du modèle 
## -2 Log L =  78742.85 
## AIC = 78776.85 
## BIC = 78900.75
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul de l'ICC (coefficient intra-classe)}
\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Intraclass Correlation Coefficient
## 
##      Adjusted ICC: 0.131
##   Conditional ICC: 0.110
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ICC3 <-}\StringTok{ }\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele3)}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Part de la variance de la variable dépendante "}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{imputable au niveau 2 : "}\NormalTok{, }\KeywordTok{round}\NormalTok{(ICC3}\OperatorTok{$}\NormalTok{ICC_adjusted}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{), }\StringTok{"%"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Part de la variance de la variable dépendante 
## imputable au niveau 2 : 13.11%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul des R2 conditionnel et marginal avec les fonctions}
\CommentTok{# r.squaredGLMM ou r2_nakagawa du package performance}
\KeywordTok{r.squaredGLMM}\NormalTok{(Modele3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            R2m      R2c
## [1,] 0.1598477 0.269979
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{r2_nakagawa}\NormalTok{(Modele3)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # R2 for Mixed Models
## 
##   Conditional R2: 0.270
##      Marginal R2: 0.160
\end{verbatim}

\hypertarget{sect08414}{%
\subsection{Le modèle avec les variables indépendantes aux niveau 1 et 2}\label{sect08414}}

Le quatrième modèle consiste à ajouter une interaction entre deux variables des de niveaux.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Variance d'interaction}
\NormalTok{Multiniveau}\OperatorTok{$}\NormalTok{PCTFRAVI_Setback <-}\StringTok{  }\NormalTok{Multiniveau}\OperatorTok{$}\NormalTok{PCTFRAVI }\OperatorTok{*}\StringTok{ }\NormalTok{Multiniveau}\OperatorTok{$}\NormalTok{Setback.c}

\CommentTok{# MODÈLE 4 : interaction aux deux niveaux}
\CommentTok{# ------------------------------------------------------}
\NormalTok{Modele4 <-}\StringTok{ }\KeywordTok{lmer}\NormalTok{(PCTArb }\OperatorTok{~}
\StringTok{                  }\CommentTok{# Variables indépendantes au niveau 1}
\StringTok{                   }\NormalTok{Width.c}\OperatorTok{+}\NormalTok{Length.c}\OperatorTok{+}\NormalTok{AgeMed.c}\OperatorTok{+}\NormalTok{AgeMed2.c}\OperatorTok{+}\NormalTok{ResiPCT.c}\OperatorTok{+}\NormalTok{DuTriPct.c}\OperatorTok{+}\NormalTok{NoLog.c}\OperatorTok{+}\NormalTok{Setback.c}\OperatorTok{+}
\StringTok{                  }\CommentTok{# Variables indépendantes au niveau 2}
\StringTok{                  }\NormalTok{ValLog}\OperatorTok{+}\NormalTok{UDipPCT}\OperatorTok{+}\NormalTok{PCTFRAVI}\OperatorTok{+}\NormalTok{PCTIMGRE}\OperatorTok{+}\NormalTok{AvecEnf}\OperatorTok{+}\NormalTok{FranPCT}\OperatorTok{+}
\StringTok{                  }\CommentTok{# Variable d'interaction}
\StringTok{                  }\NormalTok{PCTFRAVI_Setback}\OperatorTok{+}
\NormalTok{(}\DecValTok{1}\OperatorTok{|}\StringTok{ }\NormalTok{SRNOM), }\DataTypeTok{data =}\NormalTok{ Multiniveau)}

\CommentTok{# Résultats du modèle}
\KeywordTok{summary}\NormalTok{(Modele4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Linear mixed model fit by REML ['lmerMod']
## Formula: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c +  
##     DuTriPct.c + NoLog.c + Setback.c + ValLog + UDipPCT + PCTFRAVI +  
##     PCTIMGRE + AvecEnf + FranPCT + PCTFRAVI_Setback + (1 | SRNOM)
##    Data: Multiniveau
## 
## REML criterion at convergence: 78732.7
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.0148 -0.5568 -0.1922  0.2598  9.4261 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  SRNOM    (Intercept) 11.83    3.439   
##  Residual             80.24    8.958   
## Number of obs: 10814, groups:  SRNOM, 312
## 
## Fixed effects:
##                    Estimate Std. Error t value
## (Intercept)      -0.0094840  3.1984731  -0.003
## Width.c          -0.1356543  0.0127250 -10.660
## Length.c          0.0107911  0.0017159   6.289
## AgeMed.c          1.0915688  0.1851983   5.894
## AgeMed2.c        -0.0002923  0.0000478  -6.114
## ResiPCT.c         0.0460769  0.0034803  13.239
## DuTriPct.c       -0.0126785  0.0026735  -4.742
## NoLog.c           0.1453667  0.0105748  13.747
## Setback.c         0.0034430  0.0475943   0.072
## ValLog            0.0158168  0.0038196   4.141
## UDipPCT           0.0094041  0.0351462   0.268
## PCTFRAVI         -0.0788297  0.0293729  -2.684
## PCTIMGRE          0.2193705  0.0482873   4.543
## AvecEnf          -0.0070626  0.0319907  -0.221
## FranPCT           0.0498673  0.0162308   3.072
## PCTFRAVI_Setback  0.0081695  0.0017794   4.591
## fit warnings:
## Some predictor variables are on very different scales: consider rescaling
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Qualité d'ajustement du modèle}
\KeywordTok{cat}\NormalTok{(}\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{Statistiques d'ajustement du modèle"}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{-2 Log L = "}\NormalTok{, }\DecValTok{-2}\OperatorTok{*}\KeywordTok{logLik}\NormalTok{(Modele4),}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{AIC ="}\NormalTok{, }\KeywordTok{AIC}\NormalTok{(Modele3), }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{BIC ="}\NormalTok{, }\KeywordTok{BIC}\NormalTok{(Modele4))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Statistiques d'ajustement du modèle 
## -2 Log L =  78732.66 
## AIC = 78776.85 
## BIC = 78899.85
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul de l'ICC (coefficient intra-classe)}
\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # Intraclass Correlation Coefficient
## 
##      Adjusted ICC: 0.128
##   Conditional ICC: 0.108
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ICC4 <-}\StringTok{ }\NormalTok{performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele4)}
\KeywordTok{cat}\NormalTok{(}\StringTok{"Part de la variance de la variable dépendante "}\NormalTok{,}
    \StringTok{"}\CharTok{\textbackslash{}n}\StringTok{imputable au niveau 2 : "}\NormalTok{, }\KeywordTok{round}\NormalTok{(ICC4}\OperatorTok{$}\NormalTok{ICC_adjusted}\OperatorTok{*}\DecValTok{100}\NormalTok{,}\DecValTok{2}\NormalTok{), }\StringTok{"%"}\NormalTok{, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Part de la variance de la variable dépendante 
## imputable au niveau 2 : 12.85%
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Calcul des R2 conditionnel et marginal avec les fonctions}
\CommentTok{# r.squaredGLMM ou r2_nakagawa du package performance}
\KeywordTok{r.squaredGLMM}\NormalTok{(Modele4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##            R2m      R2c
## [1,] 0.1628372 0.270394
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{r2_nakagawa}\NormalTok{(Modele4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # R2 for Mixed Models
## 
##   Conditional R2: 0.270
##      Marginal R2: 0.163
\end{verbatim}

\hypertarget{sect08415}{%
\subsection{Comparaison des quatre modèles}\label{sect08415}}

Pour comparer les modèles, on utilise habituellement les statistiques d'ajustement du modèle vu plus haut, soit le maximum de vraissemblance (\emph{−2 Log-likelihood}), l'AIC, l'ICC et les R\textsuperscript{2} marginal et conditionnel.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{c_logLik <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{logLik}\NormalTok{(Modele1),}\KeywordTok{logLik}\NormalTok{(Modele2),}\KeywordTok{logLik}\NormalTok{(Modele3),}\KeywordTok{logLik}\NormalTok{(Modele4))}
\NormalTok{ICC <-}\StringTok{ }\KeywordTok{c}\NormalTok{(performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele1)}\OperatorTok{$}\NormalTok{ICC_adjusted,}
\NormalTok{         performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele2)}\OperatorTok{$}\NormalTok{ICC_adjusted,}
\NormalTok{         performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele3)}\OperatorTok{$}\NormalTok{ICC_adjusted,}
\NormalTok{         performance}\OperatorTok{::}\KeywordTok{icc}\NormalTok{(Modele4)}\OperatorTok{$}\NormalTok{ICC_adjusted)}

\NormalTok{R2m <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{r.squaredGLMM}\NormalTok{(Modele1)[}\DecValTok{1}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele2)[}\DecValTok{1}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele3)[}\DecValTok{1}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele4)[}\DecValTok{1}\NormalTok{])}

\NormalTok{R2c <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\KeywordTok{r.squaredGLMM}\NormalTok{(Modele1)[}\DecValTok{2}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele2)[}\DecValTok{2}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele3)[}\DecValTok{2}\NormalTok{],}
         \KeywordTok{r.squaredGLMM}\NormalTok{(Modele4)[}\DecValTok{2}\NormalTok{])}

\KeywordTok{print}\NormalTok{(}\KeywordTok{data.frame}\NormalTok{(}
            \DataTypeTok{Modele =} \KeywordTok{c}\NormalTok{(}\StringTok{"Modèle 1 (vide)"}\NormalTok{, }
                       \StringTok{"Modèle 2 (VI : niv. 1)"}\NormalTok{, }
                       \StringTok{"Modèle 3 (VI : niv. 1 et 2)"}\NormalTok{,}
                       \StringTok{"Modèle 4 (interaction niv. 1 et 2"}\NormalTok{),}
            \DataTypeTok{dl =} \KeywordTok{AIC}\NormalTok{(Modele1, Modele2, Modele3, Modele4)}\OperatorTok{$}\NormalTok{df,}
            \DataTypeTok{Moins2LogLik =} \KeywordTok{round}\NormalTok{(}\OperatorTok{-}\DecValTok{2}\OperatorTok{*}\NormalTok{c_logLik,}\DecValTok{0}\NormalTok{),}
            \DataTypeTok{AIC =} \KeywordTok{round}\NormalTok{(}\KeywordTok{AIC}\NormalTok{(Modele1, Modele2, Modele3, Modele4)}\OperatorTok{$}\NormalTok{AIC,}\DecValTok{0}\NormalTok{),}
            \DataTypeTok{ICC =} \KeywordTok{round}\NormalTok{(ICC,}\DecValTok{4}\NormalTok{),}
            \DataTypeTok{R2marg =} \KeywordTok{round}\NormalTok{(R2m,}\DecValTok{3}\NormalTok{),}
            \DataTypeTok{R2cond =} \KeywordTok{round}\NormalTok{(R2c,}\DecValTok{3}\NormalTok{)}
\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                              Modele dl Moins2LogLik   AIC    ICC R2marg R2cond
## 1                   Modèle 1 (vide)  3        80299 80305 0.1758  0.000  0.176
## 2            Modèle 2 (VI : niv. 1) 11        78764 78786 0.1597  0.129  0.268
## 3       Modèle 3 (VI : niv. 1 et 2) 17        78743 78777 0.1311  0.160  0.270
## 4 Modèle 4 (interaction niv. 1 et 2 18        78733 78769 0.1285  0.163  0.270
\end{verbatim}

Vous constaterez ci-haut que les valeurs d'AIC et de -2 log de vraisemblance diminuent du modèle 1 (vide) au modèle 4, signalant une amélioration progressive des modèles. Cela se traduit aussi par une augmentation du R\textsuperscript{2} conditionnel incluant à la fois les effets fixes et aléatoires. Sans surprise, la valeur du coefficient de corrélation intraclasse diminue du modèle vide au modèle complet : plus on ajoute de prédicteurs, plus la capacité explicative du niveau 2 diminue.

Il est également judicieux de vérifier si un modèle est significativement différent du modèle précédent avec la fonction \texttt{anova} qui compare les différences de leurs déviances. En guise d'exemple, la différence de déviance de 59 (\(78625-78684=59\)) entre les modèles 3 et 2 (modèle complet \emph{versus} modèle GLMM) avec six degrés de liberté -- puisque le modèle 3 inclut six variables indépendantes de plus que le précédent, \(17-11=6\) -- est significative (P\textless0,001). Cela signale que le modèle 3 est plus performant que le précédent.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{anova}\NormalTok{(Modele1, Modele2, Modele3, Modele4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Data: Multiniveau
## Models:
## Modele1: PCTArb ~ 1 + (1 | SRNOM)
## Modele2: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c + 
## Modele2:     DuTriPct.c + NoLog.c + Setback.c + (1 | SRNOM)
## Modele3: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c + 
## Modele3:     DuTriPct.c + NoLog.c + Setback.c + ValLog + UDipPCT + PCTFRAVI + 
## Modele3:     PCTIMGRE + AvecEnf + FranPCT + (1 | SRNOM)
## Modele4: PCTArb ~ Width.c + Length.c + AgeMed.c + AgeMed2.c + ResiPCT.c + 
## Modele4:     DuTriPct.c + NoLog.c + Setback.c + ValLog + UDipPCT + PCTFRAVI + 
## Modele4:     PCTIMGRE + AvecEnf + FranPCT + PCTFRAVI_Setback + (1 | SRNOM)
##         npar   AIC   BIC logLik deviance    Chisq Df Pr(>Chisq)    
## Modele1    3 80304 80326 -40149    80298                           
## Modele2   11 78706 78786 -39342    78684 1614.351  8  < 2.2e-16 ***
## Modele3   17 78659 78783 -39313    78625   59.131  6  6.758e-11 ***
## Modele4   18 78640 78771 -39302    78604   21.166  1  4.213e-06 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\hypertarget{chap09}{%
\chapter{Modèles généralisés additifs}\label{chap09}}

\hypertarget{sect091}{%
\section{Principes de base des GAM}\label{sect091}}

\hypertarget{sect092}{%
\section{Extensions des GAM}\label{sect092}}

\hypertarget{sect0921}{%
\subsection{GAMM}\label{sect0921}}

\hypertarget{sect0922}{%
\subsection{GAMMAR}\label{sect0922}}

\hypertarget{part-analyses-exploratoires-multivariuxe9es}{%
\part{Analyses exploratoires multivariées}\label{part-analyses-exploratoires-multivariuxe9es}}

\hypertarget{chap10}{%
\chapter{Méthodes factorielles}\label{chap10}}

\hypertarget{sect101}{%
\section{Un petit historique}\label{sect101}}

\hypertarget{sect102}{%
\section{Analyses de composantes principales (ACP)}\label{sect102}}

\hypertarget{sect103}{%
\section{Analyses factorielles de correspondances (AFC)}\label{sect103}}

\hypertarget{sect104}{%
\section{Analyses factorielles de correspondances multiples (AFM)}\label{sect104}}

\hypertarget{sect105}{%
\section{Analyses factorielles de correspondances mixte}\label{sect105}}

\hypertarget{chap11}{%
\chapter{Méthodes de classification non-supervisées}\label{chap11}}

\hypertarget{sect111}{%
\section{Un aperçu sur la multitude des méthodes de classications}\label{sect111}}

\hypertarget{sect112}{%
\section{Combinaisons méthodes factorielles et méthodes de classications}\label{sect112}}

\hypertarget{sect113}{%
\section{Classification ascendantes hiérachiques}\label{sect113}}

\hypertarget{sect114}{%
\section{Nuées dynamiques}\label{sect114}}

\hypertarget{sect1141}{%
\subsection{k-means}\label{sect1141}}

\hypertarget{sect1142}{%
\subsection{k-median}\label{sect1142}}

\hypertarget{sect1143}{%
\subsection{Les extensions en logique floues : c-means, c-median}\label{sect1143}}

\hypertarget{conclusion}{%
\chapter{Conclusion}\label{conclusion}}

\hypertarget{sect121}{%
\section{Synthèse des méthodes abordées}\label{sect121}}

\emph{Road map method}

\hypertarget{sect122}{%
\section{Autres méthodes non abordées}\label{sect122}}

\hypertarget{sect1221}{%
\subsection{Régressions par quantile}\label{sect1221}}

\hypertarget{sect1222}{%
\subsection{Régressions par panel}\label{sect1222}}

\hypertarget{sect1223}{%
\subsection{Régressions par Tobit}\label{sect1223}}

\hypertarget{sect1224}{%
\subsection{Analyses de survie}\label{sect1224}}

\hypertarget{sect1225}{%
\subsection{Équations structurelles}\label{sect1225}}

\hypertarget{sect123}{%
\section{Deux écoles de statistique inférielle : fréquentiste et bayésienne}\label{sect123}}

\hypertarget{sect124}{%
\section{Éthique en méthodes quantitatives}\label{sect124}}

\hypertarget{annexes}{%
\chapter{Annexes}\label{annexes}}

\hypertarget{annexe1}{%
\section{\texorpdfstring{Tableau des valeurs critiques de khi\textsuperscript{2}}{Tableau des valeurs critiques de khi2}}\label{annexe1}}

La courte syntaxe \includegraphics{Images/Rlogo.png} ci-dessous permet de générer un tableau avec les valeurs critiques du khi\textsuperscript{2} pour différents degrés de signification (valeurs de p).

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(stargazer)}

\CommentTok{# vecteur pour les degrés de liberté de 1 à 30, puis 40 et 50}
\NormalTok{dl <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{250}\NormalTok{, }\DecValTok{500}\NormalTok{) }
\CommentTok{# la fonction qchisq permet d'obtenir la valeur théorique en fonction }
\CommentTok{# d'une valeur de p et d'un nombre de degrés de liberté}
\NormalTok{tableChi2 <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(dl,}
                \DataTypeTok{p0.05 =}  \KeywordTok{round}\NormalTok{(}\KeywordTok{qchisq}\NormalTok{(}\DataTypeTok{p=}\FloatTok{0.95}\NormalTok{,  }\DataTypeTok{df=}\NormalTok{dl, }\DataTypeTok{lower.tail =} \OtherTok{FALSE}\NormalTok{),}\DecValTok{3}\NormalTok{),}
                \DataTypeTok{p0.01 =}  \KeywordTok{round}\NormalTok{(}\KeywordTok{qchisq}\NormalTok{(}\DataTypeTok{p=}\FloatTok{0.99}\NormalTok{,  }\DataTypeTok{df=}\NormalTok{dl, }\DataTypeTok{lower.tail =} \OtherTok{FALSE}\NormalTok{),}\DecValTok{3}\NormalTok{),}
                \DataTypeTok{p0.001 =} \KeywordTok{round}\NormalTok{(}\KeywordTok{qchisq}\NormalTok{(}\DataTypeTok{p=}\FloatTok{0.999}\NormalTok{, }\DataTypeTok{df=}\NormalTok{dl, }\DataTypeTok{lower.tail =} \OtherTok{FALSE}\NormalTok{),}\DecValTok{3}\NormalTok{))}
\CommentTok{# Impression du tableau avec la library stargazer}
\KeywordTok{stargazer}\NormalTok{(tableChi2, }\DataTypeTok{type=}\StringTok{"text"}\NormalTok{, }\DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{rownames=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{digits =} \DecValTok{3}\NormalTok{,}
          \DataTypeTok{title=}\StringTok{"Distribution des valeurs critiques du Khi2"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:tableCritiqueChi2}Distribution des valeurs critiques du khi2}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{rrrr}
\toprule
dl & p=0,05 & p=0,01 & p=0,001\\
\midrule
1 & 0,004 & 0,000 & 0,000\\
2 & 0,103 & 0,020 & 0,002\\
3 & 0,352 & 0,115 & 0,024\\
4 & 0,711 & 0,297 & 0,091\\
5 & 1,145 & 0,554 & 0,210\\
\addlinespace
6 & 1,635 & 0,872 & 0,381\\
7 & 2,167 & 1,239 & 0,598\\
8 & 2,733 & 1,646 & 0,857\\
9 & 3,325 & 2,088 & 1,152\\
10 & 3,940 & 2,558 & 1,479\\
\addlinespace
11 & 4,575 & 3,053 & 1,834\\
12 & 5,226 & 3,571 & 2,214\\
13 & 5,892 & 4,107 & 2,617\\
14 & 6,571 & 4,660 & 3,041\\
15 & 7,261 & 5,229 & 3,483\\
\addlinespace
16 & 7,962 & 5,812 & 3,942\\
17 & 8,672 & 6,408 & 4,416\\
18 & 9,390 & 7,015 & 4,905\\
19 & 10,117 & 7,633 & 5,407\\
20 & 10,851 & 8,260 & 5,921\\
\addlinespace
21 & 11,591 & 8,897 & 6,447\\
22 & 12,338 & 9,542 & 6,983\\
23 & 13,091 & 10,196 & 7,529\\
24 & 13,848 & 10,856 & 8,085\\
25 & 14,611 & 11,524 & 8,649\\
\addlinespace
26 & 15,379 & 12,198 & 9,222\\
27 & 16,151 & 12,879 & 9,803\\
28 & 16,928 & 13,565 & 10,391\\
29 & 17,708 & 14,256 & 10,986\\
30 & 18,493 & 14,953 & 11,588\\
\addlinespace
40 & 26,509 & 22,164 & 17,916\\
50 & 34,764 & 29,707 & 24,674\\
100 & 77,929 & 70,065 & 61,918\\
250 & 214,392 & 200,939 & 186,554\\
500 & 449,147 & 429,388 & 407,947\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{annexe2}{%
\section{Tableau des valeurs critiques de F}\label{annexe2}}

La courte syntaxe \includegraphics{Images/Rlogo.png} ci-dessous permet de générer un tableau avec les valeurs critiques de F avec \emph{p}=0,05.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(stargazer)}

\NormalTok{dl1 <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{10}\NormalTok{, }\DecValTok{15}\NormalTok{, }\DecValTok{20}\NormalTok{, }\DecValTok{25}\NormalTok{, }\DecValTok{30}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{500}\NormalTok{)}
\NormalTok{dl2 <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{100}\NormalTok{)}
\NormalTok{matrice <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\DataTypeTok{ncol=}\KeywordTok{length}\NormalTok{(dl1), }\DataTypeTok{nrow=}\KeywordTok{length}\NormalTok{(dl2), }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{(r }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(dl1))\{}
  \ControlFlowTok{for}\NormalTok{(c }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(dl2))\{}
\NormalTok{    matrice[c,r] <-}\StringTok{ }\KeywordTok{round}\NormalTok{(}\KeywordTok{qf}\NormalTok{(}\DataTypeTok{p=}\FloatTok{0.05}\NormalTok{, dl1[r], dl2[c], }\DataTypeTok{lower.tail =} \OtherTok{FALSE}\NormalTok{),}\DecValTok{2}\NormalTok{)}
\NormalTok{  \}}
\NormalTok{\}}

\NormalTok{tableF_p0}\FloatTok{.05}\NormalTok{ <-}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(matrice, }\DataTypeTok{row.names =} \KeywordTok{paste0}\NormalTok{(}\StringTok{"dl2="}\NormalTok{,dl2, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{))}
\KeywordTok{colnames}\NormalTok{(tableF_p0}\FloatTok{.05}\NormalTok{) <-}\StringTok{ }\KeywordTok{paste0}\NormalTok{(}\StringTok{"dl1="}\NormalTok{,dl1, }\DataTypeTok{sep=}\StringTok{""}\NormalTok{)}

\KeywordTok{stargazer}\NormalTok{(tableF_p0}\FloatTok{.05}\NormalTok{, }\DataTypeTok{type=}\StringTok{"text"}\NormalTok{, }\DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{rownames=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{digits =} \DecValTok{3}\NormalTok{,}
          \DataTypeTok{title=}\StringTok{"Distribution des valeurs critiques de F avec p=0,05"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:tableCritiqueF}Distribution des valeurs critiques de F avec p=0,05}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{rrrrrrrrrrrrrrrrr}
\toprule
dl1.1 & dl1.2 & dl1.3 & dl1.4 & dl1.5 & dl1.6 & dl1.7 & dl1.8 & dl1.9 & dl1.10 & dl1.15 & dl1.20 & dl1.25 & dl1.30 & dl1.50 & dl1.100 & dl1.500\\
\midrule
161,45 & 199,50 & 215,71 & 224,58 & 230,16 & 233,99 & 236,77 & 238,88 & 240,54 & 241,88 & 245,95 & 248,01 & 249,26 & 250,10 & 251,77 & 253,04 & 254,06\\
18,51 & 19,00 & 19,16 & 19,25 & 19,30 & 19,33 & 19,35 & 19,37 & 19,38 & 19,40 & 19,43 & 19,45 & 19,46 & 19,46 & 19,48 & 19,49 & 19,49\\
10,13 & 9,55 & 9,28 & 9,12 & 9,01 & 8,94 & 8,89 & 8,85 & 8,81 & 8,79 & 8,70 & 8,66 & 8,63 & 8,62 & 8,58 & 8,55 & 8,53\\
7,71 & 6,94 & 6,59 & 6,39 & 6,26 & 6,16 & 6,09 & 6,04 & 6,00 & 5,96 & 5,86 & 5,80 & 5,77 & 5,75 & 5,70 & 5,66 & 5,64\\
6,61 & 5,79 & 5,41 & 5,19 & 5,05 & 4,95 & 4,88 & 4,82 & 4,77 & 4,74 & 4,62 & 4,56 & 4,52 & 4,50 & 4,44 & 4,41 & 4,37\\
\addlinespace
5,99 & 5,14 & 4,76 & 4,53 & 4,39 & 4,28 & 4,21 & 4,15 & 4,10 & 4,06 & 3,94 & 3,87 & 3,83 & 3,81 & 3,75 & 3,71 & 3,68\\
5,59 & 4,74 & 4,35 & 4,12 & 3,97 & 3,87 & 3,79 & 3,73 & 3,68 & 3,64 & 3,51 & 3,44 & 3,40 & 3,38 & 3,32 & 3,27 & 3,24\\
5,32 & 4,46 & 4,07 & 3,84 & 3,69 & 3,58 & 3,50 & 3,44 & 3,39 & 3,35 & 3,22 & 3,15 & 3,11 & 3,08 & 3,02 & 2,97 & 2,94\\
5,12 & 4,26 & 3,86 & 3,63 & 3,48 & 3,37 & 3,29 & 3,23 & 3,18 & 3,14 & 3,01 & 2,94 & 2,89 & 2,86 & 2,80 & 2,76 & 2,72\\
4,96 & 4,10 & 3,71 & 3,48 & 3,33 & 3,22 & 3,14 & 3,07 & 3,02 & 2,98 & 2,85 & 2,77 & 2,73 & 2,70 & 2,64 & 2,59 & 2,55\\
\addlinespace
4,84 & 3,98 & 3,59 & 3,36 & 3,20 & 3,09 & 3,01 & 2,95 & 2,90 & 2,85 & 2,72 & 2,65 & 2,60 & 2,57 & 2,51 & 2,46 & 2,42\\
4,75 & 3,89 & 3,49 & 3,26 & 3,11 & 3,00 & 2,91 & 2,85 & 2,80 & 2,75 & 2,62 & 2,54 & 2,50 & 2,47 & 2,40 & 2,35 & 2,31\\
4,67 & 3,81 & 3,41 & 3,18 & 3,03 & 2,92 & 2,83 & 2,77 & 2,71 & 2,67 & 2,53 & 2,46 & 2,41 & 2,38 & 2,31 & 2,26 & 2,22\\
4,60 & 3,74 & 3,34 & 3,11 & 2,96 & 2,85 & 2,76 & 2,70 & 2,65 & 2,60 & 2,46 & 2,39 & 2,34 & 2,31 & 2,24 & 2,19 & 2,14\\
4,54 & 3,68 & 3,29 & 3,06 & 2,90 & 2,79 & 2,71 & 2,64 & 2,59 & 2,54 & 2,40 & 2,33 & 2,28 & 2,25 & 2,18 & 2,12 & 2,08\\
\addlinespace
4,49 & 3,63 & 3,24 & 3,01 & 2,85 & 2,74 & 2,66 & 2,59 & 2,54 & 2,49 & 2,35 & 2,28 & 2,23 & 2,19 & 2,12 & 2,07 & 2,02\\
4,45 & 3,59 & 3,20 & 2,96 & 2,81 & 2,70 & 2,61 & 2,55 & 2,49 & 2,45 & 2,31 & 2,23 & 2,18 & 2,15 & 2,08 & 2,02 & 1,97\\
4,41 & 3,55 & 3,16 & 2,93 & 2,77 & 2,66 & 2,58 & 2,51 & 2,46 & 2,41 & 2,27 & 2,19 & 2,14 & 2,11 & 2,04 & 1,98 & 1,93\\
4,38 & 3,52 & 3,13 & 2,90 & 2,74 & 2,63 & 2,54 & 2,48 & 2,42 & 2,38 & 2,23 & 2,16 & 2,11 & 2,07 & 2,00 & 1,94 & 1,89\\
4,35 & 3,49 & 3,10 & 2,87 & 2,71 & 2,60 & 2,51 & 2,45 & 2,39 & 2,35 & 2,20 & 2,12 & 2,07 & 2,04 & 1,97 & 1,91 & 1,86\\
\addlinespace
4,32 & 3,47 & 3,07 & 2,84 & 2,68 & 2,57 & 2,49 & 2,42 & 2,37 & 2,32 & 2,18 & 2,10 & 2,05 & 2,01 & 1,94 & 1,88 & 1,83\\
4,30 & 3,44 & 3,05 & 2,82 & 2,66 & 2,55 & 2,46 & 2,40 & 2,34 & 2,30 & 2,15 & 2,07 & 2,02 & 1,98 & 1,91 & 1,85 & 1,80\\
4,28 & 3,42 & 3,03 & 2,80 & 2,64 & 2,53 & 2,44 & 2,37 & 2,32 & 2,27 & 2,13 & 2,05 & 2,00 & 1,96 & 1,88 & 1,82 & 1,77\\
4,26 & 3,40 & 3,01 & 2,78 & 2,62 & 2,51 & 2,42 & 2,36 & 2,30 & 2,25 & 2,11 & 2,03 & 1,97 & 1,94 & 1,86 & 1,80 & 1,75\\
4,24 & 3,39 & 2,99 & 2,76 & 2,60 & 2,49 & 2,40 & 2,34 & 2,28 & 2,24 & 2,09 & 2,01 & 1,96 & 1,92 & 1,84 & 1,78 & 1,73\\
\addlinespace
4,23 & 3,37 & 2,98 & 2,74 & 2,59 & 2,47 & 2,39 & 2,32 & 2,27 & 2,22 & 2,07 & 1,99 & 1,94 & 1,90 & 1,82 & 1,76 & 1,71\\
4,21 & 3,35 & 2,96 & 2,73 & 2,57 & 2,46 & 2,37 & 2,31 & 2,25 & 2,20 & 2,06 & 1,97 & 1,92 & 1,88 & 1,81 & 1,74 & 1,69\\
4,20 & 3,34 & 2,95 & 2,71 & 2,56 & 2,45 & 2,36 & 2,29 & 2,24 & 2,19 & 2,04 & 1,96 & 1,91 & 1,87 & 1,79 & 1,73 & 1,67\\
4,18 & 3,33 & 2,93 & 2,70 & 2,55 & 2,43 & 2,35 & 2,28 & 2,22 & 2,18 & 2,03 & 1,94 & 1,89 & 1,85 & 1,77 & 1,71 & 1,65\\
4,17 & 3,32 & 2,92 & 2,69 & 2,53 & 2,42 & 2,33 & 2,27 & 2,21 & 2,16 & 2,01 & 1,93 & 1,88 & 1,84 & 1,76 & 1,70 & 1,64\\
\addlinespace
4,08 & 3,23 & 2,84 & 2,61 & 2,45 & 2,34 & 2,25 & 2,18 & 2,12 & 2,08 & 1,92 & 1,84 & 1,78 & 1,74 & 1,66 & 1,59 & 1,53\\
4,03 & 3,18 & 2,79 & 2,56 & 2,40 & 2,29 & 2,20 & 2,13 & 2,07 & 2,03 & 1,87 & 1,78 & 1,73 & 1,69 & 1,60 & 1,52 & 1,46\\
3,94 & 3,09 & 2,70 & 2,46 & 2,31 & 2,19 & 2,10 & 2,03 & 1,97 & 1,93 & 1,77 & 1,68 & 1,62 & 1,57 & 1,48 & 1,39 & 1,31\\
\bottomrule
\end{tabular}
\end{table}

\hypertarget{annexe3}{%
\section{\texorpdfstring{Tableau des valeurs critiques de \emph{t}}{Tableau des valeurs critiques de t}}\label{annexe3}}

La courte syntaxe \includegraphics{Images/Rlogo.png} ci-dessous permet de générer un tableau avec les valeurs critiques de T avec \emph{p}=0,05, 0,01 et 0,01.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(stargazer)}

\CommentTok{# vecteur pour les degrés de liberté de 1 à 30, puis 40 et 50}
\NormalTok{dl <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{30}\NormalTok{, }\DecValTok{40}\NormalTok{, }\DecValTok{50}\NormalTok{, }\DecValTok{60}\NormalTok{, }\DecValTok{70}\NormalTok{, }\DecValTok{80}\NormalTok{, }\DecValTok{90}\NormalTok{, }\DecValTok{100}\NormalTok{, }\DecValTok{250}\NormalTok{, }\DecValTok{500}\NormalTok{, }\DecValTok{1000}\NormalTok{, }\DecValTok{2500}\NormalTok{) }
\CommentTok{# la fonction qchisq permet d'obtenir la valeur théorique en fonction }
\CommentTok{# d'une valeur de p et d'un nombre de degrés de liberté}
\NormalTok{tableT <-}\StringTok{ }\KeywordTok{cbind}\NormalTok{(dl,}
                \DataTypeTok{p0.10 =}  \KeywordTok{round}\NormalTok{(}\KeywordTok{qt}\NormalTok{(}\DataTypeTok{p=}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{(}\FloatTok{0.10}\OperatorTok{/}\DecValTok{2}\NormalTok{),  }\DataTypeTok{df=}\NormalTok{dl),}\DecValTok{2}\NormalTok{),}
                \DataTypeTok{p0.05 =}  \KeywordTok{round}\NormalTok{(}\KeywordTok{qt}\NormalTok{(}\DataTypeTok{p=}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{(}\FloatTok{0.05}\OperatorTok{/}\DecValTok{2}\NormalTok{),  }\DataTypeTok{df=}\NormalTok{dl),}\DecValTok{2}\NormalTok{),}
                \DataTypeTok{p0.01 =}  \KeywordTok{round}\NormalTok{(}\KeywordTok{qt}\NormalTok{(}\DataTypeTok{p=}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{(}\FloatTok{0.01}\OperatorTok{/}\DecValTok{2}\NormalTok{),  }\DataTypeTok{df=}\NormalTok{dl),}\DecValTok{2}\NormalTok{),}
                \DataTypeTok{p0.001 =} \KeywordTok{round}\NormalTok{(}\KeywordTok{qt}\NormalTok{(}\DataTypeTok{p=}\DecValTok{1} \OperatorTok{-}\StringTok{ }\NormalTok{(}\FloatTok{0.001}\OperatorTok{/}\DecValTok{2}\NormalTok{), }\DataTypeTok{df=}\NormalTok{dl),}\DecValTok{2}\NormalTok{))}
\CommentTok{# Impression du tableau avec la library stargazer}
\KeywordTok{stargazer}\NormalTok{(tableT, }\DataTypeTok{type=}\StringTok{"text"}\NormalTok{, }\DataTypeTok{summary=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{rownames=}\OtherTok{FALSE}\NormalTok{, }\DataTypeTok{align =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{digits =} \DecValTok{2}\NormalTok{,}
          \DataTypeTok{title=}\StringTok{"Distribution des valeurs critiques de t"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{table}

\caption{\label{tab:tableCritiqueT}Distribution des valeurs critiques de t}
\centering
\fontsize{8}{10}\selectfont
\begin{tabular}[t]{rrrrr}
\toprule
dl & p0.10 & p0.05 & p0.01 & p0.001\\
\midrule
1 & 6,31 & 12,71 & 63,66 & 636,62\\
2 & 2,92 & 4,30 & 9,92 & 31,60\\
3 & 2,35 & 3,18 & 5,84 & 12,92\\
4 & 2,13 & 2,78 & 4,60 & 8,61\\
5 & 2,02 & 2,57 & 4,03 & 6,87\\
\addlinespace
6 & 1,94 & 2,45 & 3,71 & 5,96\\
7 & 1,89 & 2,36 & 3,50 & 5,41\\
8 & 1,86 & 2,31 & 3,36 & 5,04\\
9 & 1,83 & 2,26 & 3,25 & 4,78\\
10 & 1,81 & 2,23 & 3,17 & 4,59\\
\addlinespace
11 & 1,80 & 2,20 & 3,11 & 4,44\\
12 & 1,78 & 2,18 & 3,05 & 4,32\\
13 & 1,77 & 2,16 & 3,01 & 4,22\\
14 & 1,76 & 2,14 & 2,98 & 4,14\\
15 & 1,75 & 2,13 & 2,95 & 4,07\\
\addlinespace
16 & 1,75 & 2,12 & 2,92 & 4,01\\
17 & 1,74 & 2,11 & 2,90 & 3,97\\
18 & 1,73 & 2,10 & 2,88 & 3,92\\
19 & 1,73 & 2,09 & 2,86 & 3,88\\
20 & 1,72 & 2,09 & 2,85 & 3,85\\
\addlinespace
21 & 1,72 & 2,08 & 2,83 & 3,82\\
22 & 1,72 & 2,07 & 2,82 & 3,79\\
23 & 1,71 & 2,07 & 2,81 & 3,77\\
24 & 1,71 & 2,06 & 2,80 & 3,75\\
25 & 1,71 & 2,06 & 2,79 & 3,73\\
\addlinespace
26 & 1,71 & 2,06 & 2,78 & 3,71\\
27 & 1,70 & 2,05 & 2,77 & 3,69\\
28 & 1,70 & 2,05 & 2,76 & 3,67\\
29 & 1,70 & 2,05 & 2,76 & 3,66\\
30 & 1,70 & 2,04 & 2,75 & 3,65\\
\addlinespace
40 & 1,68 & 2,02 & 2,70 & 3,55\\
50 & 1,68 & 2,01 & 2,68 & 3,50\\
60 & 1,67 & 2,00 & 2,66 & 3,46\\
70 & 1,67 & 1,99 & 2,65 & 3,44\\
80 & 1,66 & 1,99 & 2,64 & 3,42\\
\addlinespace
90 & 1,66 & 1,99 & 2,63 & 3,40\\
100 & 1,66 & 1,98 & 2,63 & 3,39\\
250 & 1,65 & 1,97 & 2,60 & 3,33\\
500 & 1,65 & 1,96 & 2,59 & 3,31\\
1 000 & 1,65 & 1,96 & 2,58 & 3,30\\
\addlinespace
2 500 & 1,65 & 1,96 & 2,58 & 3,29\\
\bottomrule
\end{tabular}
\end{table}

  \bibliography{book.bib}

\printindex

\end{document}
